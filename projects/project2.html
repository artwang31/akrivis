---
title: Staff Retention Analysis
sub-title: Statistical modeling and testing
video: https://www.youtube.com/embed/C_-zzCAaFRM
script-name: Script written in R | Demographics Cleanup.R
script2-name: Script written in R | Demographics Join.R
---
<section class="title-and-description">
    <h1>{{ page.title }}</h1>
    <h2>{{ page.sub-title }}</h2>
    <div class="description">
        <!-- Your Paragraph goes here! -->
    </div>
</section>

<!-- <section class="embeded-video">
    <div class="all-videos">
        <div class="each">
            <iframe src="{{ page.video }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
        <div class="each">
            <iframe src="{{ page.video }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    </div>
</section> -->

<section class="script-description">
    <p>{{ page.script-name }}</p>
</section>

<section class="codes">
{% highlight r linenos %}

    # Author: Artemas Wang

    # Loading required packages
    library(data.table)
    library(tidyverse)
    library(tidyr)

    # Reading in data
    original_data <- fread(paste0("Sample Data.csv"), header = T, stringsAsFactors = F, data.table = T)
    original_roster_data <- fread(paste0("Employee Roster-Table.1csv"), header = T, stringsAsFactors = F, data.table = T)

    roster <- original_roster_data
    data_sample <- original_data

    # Learning about data
    nrow(data_sample)
    nrow(roster) 
    nrow(colnames)

    ### Cleaning Org Health data

    # Getting rid of the useless extra "Associate ID" column/variable
    data_sample <- data_sample[3:nrow(data_sample),1:53]

    # Selecting relevant variables and getting rid of duplicate Associate Id entries
    data_sample <- data_sample %>% select("Race/Ethnicity", "FG", "Associate ID") %>% 
                        distinct(`Associate ID`,.keep_all = TRUE)
    str(data_sample)

    # Renaming Associate ID for future merge
    data_sample$Associate_ID <- data_sample$`Associate ID`
    data_sample$`Associate ID` <- NULL

    # Checking to see if there are any NA values within observations
    which(is.na(data_sample$`Race/Ethnicity`))
    which(is.na(data_sample$FG))
    which(is.na(data_sample$`Associate ID`))

    ## Checking to see unique values within each variable & fixing them

    # Race and Ethnicity into Separate Columns
    data_sample$Race_Description <- ifelse(data_sample$`Race/Ethnicity` == "" |
                                        data_sample$`Race/Ethnicity` == "I prefer not to respond" , "Not Specified", 
                                        data_sample$`Race/Ethnicity`)
    data_sample$`Race/Ethnicity` <- NULL 

    data_sample$Ethnicity <- ifelse(data_sample$Race_Description == "Not Specified" |
                                data_sample$Race_Description == "", "Not Specified",
                            ifelse(data_sample$Race_Description == "Asian" |
                                data_sample$Race_Description == "White" |
                                data_sample$Race_Description == "American Indian or Alaska Native" |
                                data_sample$Race_Description == "Native Hawaiian or Other Pacific Islander" |
                                data_sample$Race_Description == "Two or More Races" |
                                data_sample$Race_Description == "Black or African-American" |
                                data_sample$Race_Description == "Other", "",
                            ifelse(data_sample$Race_Description == "Hispanic or Latino", "Hispanic or Latino", "Not Hispanic or Latino")))
                            
    # First Grad
    data_sample$First_Generation_College_Graduate <- ifelse(data_sample$FG == "" |
                            data_sample$FG == "I prefer not to respond", "Not Specified", data_sample$FG)
    data_sample$FG <- NULL

    ## Cleaning Roster data
    # Selecting relevant variables and getting rid of duplicate Associate Id entries
    roster <- roster %>% select("NAME","ASSOCIATE ID", "POSITION ID") %>% 
                distinct(`ASSOCIATE ID`,.keep_all = TRUE) # 2350 rows now

    # Renaming Associate ID for future merge
    roster$Associate_ID <- roster$`ASSOCIATE ID`
    roster$`ASSOCIATE ID` <- NULL

    # Checking to see if there are any NA values within observations=
    which(is.na(roster$NAME))
    which(is.na(roster$`ASSOCIATE ID`))
    which(is.na(roster$`JOB TITLE`))

    # Splitting Name into First and Last
    roster <- separate(data = roster, col = NAME, into = c("Last Name", "First Name"), sep = "\\,")
    trimws(roster$`Last Name`)
    trimws(roster$`First Name`)

    # Merging two datasets on Associate ID
    employees_final <- merge(x = data_sample, y = roster, by = "Associate_ID", all.x = TRUE)
    employees_final <- employees_final %>% select("Associate_ID", "POSITION ID", "First Name", "Last Name",
                                                "Race_Description", "Ethnicity", "First_Generation_College_Graduate")


    # Writing to CSV
    write.csv(employees_final, file="Employees to ADP.csv", row.names = FALSE)
{% endhighlight %}
</section>

<section class="script-description">
    <p>{{ page.script2-name }}</p>
</section>

<section class="codes">
{% highlight r linenos %}

    # Author: Artemas Wang

    # Loading required packages
    library(data.table)
    library(tidyverse)
    library(tidyr)

    # Reading in data
    custom_fields <- fread(paste0("sample_data1.csv"), header = T, stringsAsFactors = F, data.table = T)
    cleaned_data <- fread(paste0("sample_data2.csv"), header = T, stringsAsFactors = F, data.table = T)

    custom <- custom_fields
    custom$Associate_ID <- custom$`Associate ID`

    custom <- custom %>% select("Associate_ID", "Position ID","First Name", "Last Name", "Race Description", "Ethnicity", 
                                "First Generation College Graduate")

    cleaned_data_final <- cleaned_data

    employees <- merge(x = custom, y = cleaned_data_final, by = "Associate_ID", all.x = TRUE)

    employees$Race.Description <- ifelse(employees$`Race Description` == employees$Race_Description, 
                                        employees$Race_Description, employees$`Race Description`)

    employees$Ethnicity <- ifelse(employees$Ethnicity.x == employees$Ethnicity.y, 
                                employees$Ethnicity.y, employees$Ethnicity.x)

    employees$First.Gen.College.Grad <- ifelse(employees$`First Generation College Graduate` == employees$First_Generation_College_Graduate, 
                                            employees$First_Generation_College_Graduate, employees$`First Generation College Graduate`)

    variable_selection <- c(1:4, 14:16)
    employees <- employees %>% select(variable_selection)


    # Recreating fields
    employees$Race.Description <- ifelse(employees$Race.Description == "" |
                                            is.na(employees$Race.Description), "Not Specified", 
                                            employees$Race.Description)

    employees$Ethnicity <- ifelse(employees$Race.Description == "" |
                                        is.na(employees$Ethnicity) , "Not Specified", 
                                        employees$Ethnicity)

    employees$First.Gen.College.Grad <- ifelse(employees$First.Gen.College.Grad == "" |
                                        is.na(employees$First.Gen.College.Grad), "Not Specified", 
                                        employees$First.Gen.College.Grad)

    # Writing to CSV
    write.csv(employees, file="Employees Final.csv", row.names = FALSE)

{% endhighlight %}
</section>

<script>
    $(window).ready(function(){
    
    // These are the only two lines need changing. First bracket states where you intend the paragraph to be situated, second bracket states where the paragraph is located at.

    // Just change the file name behind paragraphs/ to the corresponding one.
    $('.description').empty();
    $('.description').load('/akrivis/paragraphs/project2');

    });
</script>